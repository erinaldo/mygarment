SELECT '2014-11-27 11:14:16' dateFrom,'2014-11-27 11:14:16' dateTo,DT.ITEMSID,tblmitems.DESCRIPTION,
DT.UOM,SUM(DT.OPENING) OPENING,SUM(DT.PEMASUKAN) PEMASUKAN,SUM(DT.PENGELUARAN) PENGELUARAN,
SUM(DT.PENYESUAIAN)PENYESUAIAN,SUM(DT.CLOSING) CLOSING,SUM(DT.STOCKOPNAME) OPNAME,SUM(DT.SELISIH) SELISIH
FROM
(
SELECT 
tblgrndetail.ITEMSID,
tblgrndetail.UOM,
CASE WHEN date(tblgrn.DATE) <  date('2014-11-27 11:14:16') THEN tblgrndetail.QUANTITY ELSE 0 END OPENING,
CASE WHEN date(tblgrn.DATE) BETWEEN date('2014-11-27 11:14:16') AND date('2014-11-27 11:14:16')THEN tblgrndetail.QUANTITY ELSE 0 END PEMASUKAN,
0 PENGELUARAN, 0 PENYESUAIAN,
CASE WHEN date(tblgrn.DATE) <= date('2014-11-27 11:14:16') THEN tblgrndetail.QUANTITY ELSE 0 END CLOSING,
0 STOCKOPNAME,0 SELISIH
FROM tblgrn
INNER JOIN tblgrndetail ON tblgrndetail.GRNNO=tblgrn.GRNNO
WHERE tblgrndetail.JENIS='PRODUCT'

UNION ALL

SELECT 
tblgindetail.ITEMSID,
tblgindetail.UOM,
CASE WHEN date(tblgin.DATE) <  date('2014-11-27 11:14:16') THEN -1*tblgindetail.QUANTITY ELSE 0 END OPENING,
0 PEMASUKAN,
CASE WHEN date(tblgin.DATE) BETWEEN date('2014-11-27 11:14:16') AND date('2014-11-27 11:14:16')THEN tblgindetail.QUANTITY ELSE 0 END PENGELUARAN,
0 PENYESUAIAN,
CASE WHEN date(tblgin.DATE) <= date('2014-11-27 11:14:16') THEN -1*tblgindetail.QUANTITY ELSE 0 END CLOSING,
0 STOCKOPNAME,0 SELISIH
FROM tblgin
INNER JOIN tblgindetail ON tblgin.GINNO=tblgindetail.GINNO
WHERE tblgindetail.JENIS='PRODUCT'
)DT
INNER JOIN tblmitems ON tblmitems.ITEMSID=DT.ITEMSID

GROUP BY DT.ITEMSID,tblmitems.DESCRIPTION,DT.UOM